/*! WP User Manager - v0.1.0
 * http://wp-user-manager.com
 * Copyright (c) 2015; * Licensed GPLv2+ */
jQuery(document).ready(function(a){var b={init:function(){this.ajax_login(),this.ajax_psw_recovery(),this.ajax_psw_reset(),this.ajax_profile_update(),this.ajax_registration()},ajax_login:function(){a(".wpum-login-form form").on("submit",function(b){b.preventDefault();var c=this,d=a(this).find("p.login-username").children("input[type=text]").val(),e=a(this).find("p.login-password").children("input[type=password]").val(),f=a(this).find("p.login-remember label").children("input[type=checkbox]").is(":checked"),g=a(this).find("#wpum_nonce_login_security").val(),h=a(this).parent("div.wpum-login-form").data("redirect");a.ajax({type:"GET",dataType:"json",url:wpum_frontend_js.ajax,data:{action:"wpum_ajax_login",username:d,password:e,rememberme:f,wpum_nonce_login_security:g},beforeSend:function(){a(c).find("p.wpum-message").remove(),a(c).prepend('<p class="wpum-message wpum-notice">'+wpum_frontend_js.checking_credentials+"</p>")},success:function(b){b.loggedin===!0?(a(c).find("p.wpum-message").removeClass("wpum-notice").addClass("wpum-success").text(b.message),window.location.href=h):a(c).find("p.wpum-message").removeClass("wpum-notice").addClass("wpum-error").text(b.message)}})})},checkPasswordStrength:function(a,b,c,d){var e=a.val();b.removeClass("short bad good strong"),d=d.concat(wp.passwordStrength.userInputBlacklist());var f=wp.passwordStrength.meter(e,d);switch(f){case 2:b.addClass("bad").html(pwsL10n.bad);break;case 3:b.addClass("good").html(pwsL10n.good);break;case 4:b.addClass("strong").html(pwsL10n.strong);break;case 5:b.addClass("short").html(pwsL10n.mismatch);break;default:b.addClass("short").html(pwsL10n["short"])}return f},ajax_psw_recovery:function(){a(".wpum-password-form-wrapper-recover form").on("submit",function(b){b.preventDefault();var c=this,d=a(this).find("#username_email").val(),e=a(this).find("#_wpnonce").val(),f=a(this).find("#wpum_password_form_status").val();a.ajax({type:"GET",dataType:"json",url:wpum_frontend_js.ajax,data:{action:"wpum_ajax_psw_recovery",username:d,form_status:f,wpum_nonce_psw_security:e},beforeSend:function(){a(c).find("p.wpum-message").remove(),a(c).prepend('<p class="wpum-message wpum-notice">'+wpum_frontend_js.checking_credentials+"</p>")},success:function(b){b.valid===!0?a(c).find("p.wpum-message").removeClass("wpum-notice").addClass("wpum-success").text(b.message):a(c).find("p.wpum-message").removeClass("wpum-notice").addClass("wpum-error").text(b.message)}})})},ajax_psw_reset:function(){a(".wpum-password-form-wrapper-reset form").on("submit",function(b){b.preventDefault();var c=this,d=a(this).find("#password_1").val(),e=a(this).find("#password_2").val(),f=a(this).find("#_wpnonce").val(),g=a(this).find("#wpum_password_form_status").val(),h=a(this).find("input:hidden[name='wpum_psw_reset_key']").val(),i=a(this).find("input:hidden[name='wpum_psw_reset_login']").val();a.ajax({type:"GET",dataType:"json",url:wpum_frontend_js.ajax,data:{action:"wpum_ajax_psw_reset",password_1:d,password_2:e,form_status:g,key:h,login:i,wpum_nonce_psw_security:f},beforeSend:function(){a(c).find("p.wpum-message").remove(),a(c).prepend('<p class="wpum-message wpum-notice wpum-lost-psw-message">'+wpum_frontend_js.checking_credentials+"</p>")},success:function(b){b.completed===!0?a(c).find("p.wpum-message").removeClass("wpum-notice").addClass("wpum-success wpum-lost-psw-message").text(b.message):a(c).find("p.wpum-message").removeClass("wpum-notice").addClass("wpum-error wpum-lost-psw-message").text(b.message)}})})},ajax_profile_update:function(){a("#wpum-form-profile form").on("submit",function(b){b.preventDefault();var c=this,d=a(this).find("#_wpnonce").val(),e=a(this).find("#wpum_user_id").val();dataArray=a.map(a(this).children("fieldset"),function(b){return{id:a(b).data("name"),type:a(b).data("type"),label:a(b).data("label"),required:a(b).data("required"),value:a(b).find("[name="+a(b).data("name")+"]").val()}}),a.ajax({type:"GET",dataType:"json",url:wpum_frontend_js.ajax,data:{action:"wpum_update_profile",wpum_profile_nonce:d,fields:dataArray,user_id:e},beforeSend:function(){a(c).find("p.wpum-message").remove(),a(c).prepend('<p class="wpum-message wpum-notice wpum-profile-updated-message">'+wpum_frontend_js.checking_credentials+"</p>")},success:function(b){b.valid===!0?(a(c).find("p.wpum-message").removeClass("wpum-notice").addClass("wpum-success").text(b.message),location.reload(!0)):a(c).find("p.wpum-message").removeClass("wpum-notice").addClass("wpum-error").text(b.message)}})})},ajax_registration:function(){}};b.init(),1==wpum_frontend_js.pwd_meter&&a("body").on("keyup","input[name=password]",function(){b.checkPasswordStrength(a(".wpum-default-registration-form-wrapper input[name=password], .wpum-profile-form-wrapper input[name=password]"),a(".wpum-default-registration-form-wrapper #password-strength, .wpum-profile-form-wrapper #password-strength"),a("#submit_wpum_register, #submit_wpum_profile"),["admin","administrator","test","user","demo"])})});